<!DOCTYPE html><html><head><meta charset="utf8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><title>Sesiones CodeIgniter terminan inmediatamente</title><meta name="description" content="Welling Guzman is a software engineer, and this is his writing in third person."><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="author" content="undefined"><link rel="shortcut icon" href="/favicon.ico"><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.2"></head><body class="notes"><div class="sitebar"><div class="Content-wrapper"><a href="/" class="site-title"><span class="first">welling</span><span class="last">guzman</span></a><nav class="site-nav"><ul class="nav-links"><li><a href="/">home</a></li><li><a href="/notes">notes</a></li><li><a href="/about">about</a></li></ul></nav></div></div><header class="Main-header no-image"><div class="Header-content"></div></header><div class="Content-wrapper"><div class="Content"><article class="Post"><header class="Post-header"><h1 class="Post-title">Sesiones CodeIgniter terminan inmediatamente</h1><h4 class="Post-meta"><span class="Timestamp">Saturday, January 19th, 2013</span></h4></header><div class="Post-content"><p>He estado utilizando <strong>Codeigniter</strong> por mucho tiempo localmente y remotamente pero nunca me habia pasado algo como esto, tratando de utilizar las sesiones localmente funcionaban sin ningún problema, pero al utilizarlo en un servidor, las sesiones no querían funcionar, no querían almacenarse ni mantenerse su tiempo indicado en la configuración de CodeIgniter.</p>

<p><span id="more-36"></span></p>
<p>En <strong>CodeIgniter 2.1.3</strong> es la version que utilizo actualmente tiene por defecto estas configuraciones de sesión.</p>

<h2>Sesiones CodeIgniter</h2>

<pre rel="php" class="editor editor-colors"><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="punctuation section embedded begin php"><span>&lt;?php</span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>config</span></span><span class="punctuation section array begin php"><span>[</span></span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>sess_cookie_name</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span class="punctuation section array end php"><span>]</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>ci_session</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>config</span></span><span class="punctuation section array begin php"><span>[</span></span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>sess_expiration</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span class="punctuation section array end php"><span>]</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="constant numeric php"><span>7200</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>config</span></span><span class="punctuation section array begin php"><span>[</span></span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>sess_expire_on_close</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span class="punctuation section array end php"><span>]</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="constant language php"><span>FALSE</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>config</span></span><span class="punctuation section array begin php"><span>[</span></span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>sess_encrypt_cookie</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span class="punctuation section array end php"><span>]</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="constant language php"><span>FALSE</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>config</span></span><span class="punctuation section array begin php"><span>[</span></span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>sess_use_database</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span class="punctuation section array end php"><span>]</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="constant language php"><span>FALSE</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>config</span></span><span class="punctuation section array begin php"><span>[</span></span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>sess_table_name</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span class="punctuation section array end php"><span>]</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>ci_sessions</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>config</span></span><span class="punctuation section array begin php"><span>[</span></span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>sess_match_ip</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span class="punctuation section array end php"><span>]</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="constant language php"><span>FALSE</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>config</span></span><span class="punctuation section array begin php"><span>[</span></span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>sess_match_useragent</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span class="punctuation section array end php"><span>]</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="constant language php"><span>TRUE</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div><div class="line"><span class="text html php"><span class="meta embedded block php"><span class="source php"><span class="variable other php"><span class="punctuation definition variable php"><span>$</span></span><span>config</span></span><span class="punctuation section array begin php"><span>[</span></span><span class="string quoted single php"><span class="punctuation definition string begin php"><span>&#39;</span></span><span class="meta string-contents quoted single php"><span>sess_time_to_update</span></span><span class="punctuation definition string end php"><span>&#39;</span></span></span><span class="punctuation section array end php"><span>]</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword operator assignment php"><span>=</span></span><span>&nbsp;</span><span class="constant numeric php"><span>300</span></span><span class="punctuation terminator expression php"><span>;</span></span></span></span></span></div></pre>
<p>Como podrán notar en <code>$config[&#39;sess_expiration&#39;]    = 7200;</code> nos indica que la session expirara después de 7200 segundos de ser creada, que resulta ser 2 horas, la cual se ira actualizando en cada ejecución y en fin el caso seria que si dura 2 horas (7200 segundos) inactiva expirara.</p>

<p>Esto me estaba funcionando perfectamente en mi servidor local hasta que trate de subirlo a un servidor remoto en la cual no encontraba cual seria el problema que no podia iniciar sesión, pense que el servidor no me estaba guardando o trabajando las sesiones pero si las almacenabas.</p>

<p>Investigando encontre el <em>problema</em> y la <em>solución</em>.</p>

<p><h2>Problema</h2></p>
<p>El problema estaba en que el servidor remoto estaba en un pais con diferencia de horario mayor a 2 horas a mi pais de residencia, la cual el problema funcionaba de esta manera:</p>
<ol>
<li>Iniciaba Sesión en la web a las 08:00am.</li>
<li>El servidor creaba las sesiones y le indicaba al navegador local que esta sesión expiran en 2 horas de su hora local que es 01:00am, la cual nos indica que la sesión habra terminado a las 03:00am si no la consultan antes de esta hora.</li>
<li>Cuando inmediatamente volvia a preguntar por la sesión que acaba de crear... ¡BANG! no funciona porque ya expiro a las 03:00am hace 5 horas según el servidor, según mi navegador (cliente local) no es nada cierto.</li>
</ol>
<h2>Solución</h2>
<p>
Pues la solución es bastante simple, Incrementar el tiempo de expiración de la sesión, la cual seria 1 dia, así no encontraríamos ningún problema con el servidor y el cliente. Hay ciertos países que tienen casi 1 dia de diferencia así que pueden variar o elegir el valor que prefieran.
</p></div><footer class="Post-footer"><div class="Post-signature">—<a href="http://twitter.com/WellingGuzman" target="_blank">@WellingGuzman</a></div></footer></article></div></div><footer id="footer"><div class="Content-wrapper"><div class="Site-footer-links"><a href="/about">About</a>•<a target="_blank" href="https://twitter.com/WellingGuzman">Twitter</a>•<a target="_blank" href="https://github.com/WellingGuzman">GitHub</a></div><div class="copyright">Copyright &copy; 2013&nbsp;<a href="https://plus.google.com/109985810023249441310/posts" rel="publisher">Welling Guzman</a></div></div></footer><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-37732822-1', 'auto');
ga('send', 'pageview');</script></body></html>